请根据我的原始代码和失败的 patch，生成最终的完整代码。

用户的原始意图是: ${context.intention}

Here is the original code:

${context.oldCode}

Here is the failed patched context:

${context.patchedCode}

请返回应用 patch 后的最终代码。
